# 🐾 실시간 대화 번역기

**Zoom / Google Meet** 회의 중 **상대방의 음성**을 실시간으로 번역해주는 웹 애플리케이션입니다.

**일본어 ↔ 한국어 양방향 지원!**

---

## ✨ 주요 기능

### 🎯 핵심 기능
- 🎧 **시스템 오디오 캡처**: BlackHole을 사용하여 화상회의 음성 캡처
- 🎤 **실시간 음성 인식**: Web Speech API로 음성을 텍스트로 변환
- 🌐 **고품질 번역**: DeepL API를 사용한 프리미엄 번역 (월 50만자 무료)
- 🔄 **양방향 번역**: 일본어→한국어, 한국어→일본어 모두 지원
- 📚 **용어집 학습**: 엑셀 파일에서 전문 용어 학습 (195개 게임 용어 내장)
- ⚡ **빠른 처리**: 1-2초 내 실시간 번역

### 📱 UI/UX
- 🐾 **귀여운 디자인**: 고양이 발바닥 아이콘과 애니메이션
- 📺 **플로팅 자막**: 화면 최상단에 떠다니는 자막 (회의 화면 위에 표시)
- ⌨️ **키보드 단축키**: `-`, `=`, `9`, `0` 키로 빠른 조작
- 📱 **네트워크 공유**: 같은 와이파이의 다른 기기에서 접속 가능
- 🎨 **컴팩트 UI**: 1줄 헤더로 화면 공간 최대화

### 💾 데이터 관리
- 📂 **세션 관리**: 최대 10개 세션 자동 저장, 대화 시작/중지마다 저장
- 🗂️ **히스토리**: 번역 내역 저장 및 관리
  - ⭐ 중요 표시 기능
  - 🗑️ 개별/전체 삭제
  - 📋 클립보드 복사
  - 📤 텍스트 파일 내보내기
- 🔍 **검색 기능**: 모든 세션에서 원문/번역 검색
- 🕐 **시간대별 그룹화**: 5분 단위로 자동 그룹화

### 🔧 편의 기능
- 🚀 **자동 시작**: Mac 부팅 시 서버 자동 실행 (선택사항)
- 🔄 **세션 탭**: 이전 대화 기록을 탭으로 빠르게 전환
- ❌ **세션 삭제**: 마우스 오버 시 × 버튼으로 즉시 삭제
- 🎯 **다양한 플랫폼**: Zoom, Google Meet 모두 지원

---

## 🚀 빠른 시작 (5분 설정)

### 준비물
1. **Mac 컴퓨터** (macOS 10.13 이상)
2. **Chrome 브라우저**
3. **DeepL API 키** (무료, https://www.deepl.com/ko/pro-api)

### 설치 및 실행

#### 1단계: 의존성 설치
```bash
cd /Users/t-drhee/Desktop/개발폴더/음성번역
npm install
```

#### 2단계: 용어집 로드 (선택사항)
```bash
npm run load-terms
```
💡 게임 관련 195개 전문 용어가 자동으로 번역에 반영됩니다!

#### 3단계: 서버 시작

**방법 1: 수동 실행** (필요할 때만)
```bash
npm start
```

**방법 2: 자동 실행** (Mac 부팅 시 자동 시작 - 권장!)
```bash
./server-control.sh start
```

**서버 제어 명령어:**
```bash
./server-control.sh status   # 서버 상태 확인
./server-control.sh stop     # 서버 중지
./server-control.sh restart  # 서버 재시작
./server-control.sh disable  # 자동 시작 비활성화
./server-control.sh logs     # 서버 로그 보기
./server-control.sh errors   # 에러 로그 보기
```

💡 **자동 실행 설정 시**: 맥북을 켤 때마다 자동으로 서버가 시작됩니다. (배터리 영향: 미미)

#### 4단계: 브라우저 접속
- **이 컴퓨터에서**: http://localhost:3000
- **같은 와이파이의 다른 기기에서**:
  - 페이지 우측 상단 **📱 다른 기기** 버튼 클릭
  - 표시되는 IP 주소 또는 QR 코드로 접속
  - 예: http://192.168.x.x:3000

#### 5단계: API 키 입력
1. 우측 상단 **🔑** 버튼 클릭
2. DeepL API 키 붙여넣기
3. **저장** 버튼 클릭

#### 6단계: 사용 시작!
- 대면 대화: 그냥 **시작 (-)** 클릭
- 화상회의: 아래 설정 가이드 참고 → **시작 (-)** 클릭

---

## 🎧 Zoom/Meet 화상회의 설정 (10분)

화상회의에서 **상대방 목소리를 번역**하려면 BlackHole 설정이 필요합니다.

### 📦 1단계: BlackHole 설치 (5분)

**BlackHole이란?** Mac 내부 소리를 앱에서 캡처할 수 있게 해주는 무료 가상 오디오 케이블입니다.

#### 설치 방법:
```bash
# Homebrew가 없으면 먼저 설치
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# BlackHole 설치
brew install blackhole-2ch
```

✅ **설치 후 Mac을 재부팅하세요!** (필수)

---

### 🔧 2단계: 오디오 믹서 설정 (3분)

**목적:** 소리가 스피커와 BlackHole 양쪽으로 동시에 나가게 만들기

1. **Spotlight 검색** (⌘ + Space) → `Audio MIDI` 입력 → **Audio MIDI Setup** 실행

2. 왼쪽 하단 **➕ 버튼** 클릭

3. **"다중 출력 장치 생성"** (Create Multi-Output Device) 클릭

4. 오른쪽 목록에서 **2개 체크**:
   - ✅ **BlackHole 2ch** (먼저)
   - ✅ **MacBook Pro 스피커** (두 번째)

5. (선택) 이름을 더블클릭해서 **"번역기용"**으로 변경

✅ **확인:** "다중 출력 장치" 또는 "번역기용"이 목록에 보이면 성공!

💡 **중요:** 이 설정으로 맥북 볼륨을 0으로 해도 번역은 정상 작동합니다!

---

### 🎤 3단계: Zoom/Meet 스피커 변경 (1분)

#### 📹 Zoom
1. Zoom 실행 → 우측 상단 **⚙️** → **오디오**
2. **스피커** → **"다중 출력 장치"** 선택
3. 마이크는 **그대로** 두세요!

#### 📹 Google Meet
1. Meet 회의 입장 → 우측 하단 **⋮** → **설정**
2. **오디오** 탭 → **스피커** → **"다중 출력 장치"** 선택
3. 마이크는 **그대로** 두세요!

---

### 🎯 4단계: 번역기 실행 (30초)

1. 번역기 페이지 상단 **오디오 장치 드롭다운** → **"BlackHole 2ch ⭐ (권장)"** 선택
2. **듣기 언어** 선택 (또는 단축키 사용):
   - 일본인 상대방 → **🎧 일본어 듣기 (0)**
   - 한국인 상대방 → **🎧 한국어 듣기 (9)**
3. **"시작 (-)"** 클릭!

🎉 **완료!** Zoom/Meet에서 상대방이 말하면 실시간으로 번역됩니다!

---

## ⌨️ 키보드 단축키

빠른 조작을 위한 키보드 단축키:

- **`-` (마이너스)**: 시작
- **`=` (이퀄)**: 중지
- **`9`**: 한국어 듣기 모드
- **`0`**: 일본어 듣기 모드
- **`Ctrl + Space`**: 시작/중지 토글
- **`ESC`**: 모달 닫기

💡 검색창이나 입력창에 포커스가 있을 때는 단축키가 작동하지 않습니다.

---

## 💡 사용 팁

### 대면 대화 번역
- 노트북을 가운데 두고 한/일 양쪽이 자유롭게 대화
- 말하는 사람 언어에 맞춰 단축키 사용:
  - 일본인이 말하기 전: `0` 키 (일본어 듣기)
  - 한국인이 말하기 전: `9` 키 (한국어 듣기)

### 화상회의 번역
- 상대방 언어를 미리 선택하고 시작
- 상대방 목소리만 정확히 번역됨
- **맥북 볼륨을 0으로 해도 번역은 정상 작동합니다!**

### 두 개의 탭 활용 (권장!)
1. `http://localhost:3000` 을 **2개 탭**으로 열기
2. **탭1**: "🎧 일본어 듣기 (0)" → 일본어를 한국어로
3. **탭2**: "🎧 한국어 듣기 (9)" → 한국어를 일본어로
4. 양쪽 나란히 배치하면 양방향 동시 번역!

### 세션 관리
- 시작-중지 사이클마다 자동으로 세션 저장
- 최대 10개 세션 보관 (오래된 것 자동 삭제)
- 세션 탭에 마우스 오버 → **×** 버튼으로 삭제
- 검색창에서 모든 세션의 대화 검색 가능

### 히스토리 관리
- **⭐ 버튼**: 중요한 대화 표시
- **🗑️ 버튼**: 개별 삭제
- **전체 복사**: 클립보드에 복사
- **내보내기**: 텍스트 파일로 저장

---

## 🎨 화면 구성

### 상단 헤더 (1줄)
```
[🐾 실시간 대화 번역기] ...... [오디오 장치 ▼] [🔄] [📖] [📱] [🔑]
```
- 🐾: 귀여운 고양이 발바닥 (흔들흔들!)
- 🔄: 새로고침
- 📖: 설정 가이드
- 📱: 다른 기기 접속 정보
- 🔑: API 키 입력

### 컨트롤 라인
```
[🎧 한국어 듣기 (9)] [🎧 일본어 듣기 (0)] [시작 (-)] [중지 (=)] [● 대기 중]
```

### 현재 자막
```
원문 → 번역
```

### 대화 기록
- **이전 대화**: 세션 탭 (날짜/시간 표시)
- **검색**: 모든 세션에서 검색
- **내보내기/전체 복사/지우기**: 히스토리 관리
- **시간대별 그룹화**: 5분 단위 구분선
- **별표/삭제**: 각 항목마다 버튼

### 플로팅 자막
- 화면 최상단 중앙에 표시
- 번역 결과만 크게 표시
- 5초간 표시 후 자동 사라짐

---

## 📚 용어집 학습 기능

전문 용어를 정확하게 번역하기 위한 용어집 시스템!

### 내장 용어집
- **195개 게임 관련 용어** 자동 적용
- 예: "챕터" → "エリア", "이벤트 스테이지" → "イベントステージ"

### 용어집 업데이트
1. 엑셀 파일(`[ID팀] 번역 AI 학습용 한_일 리스트.xlsx`)을 Downloads 폴더에 저장
2. `load-terms.js`에서 파일 경로 확인
3. 터미널에서 실행:
```bash
npm run load-terms
```
4. 서버 재시작:
```bash
./server-control.sh restart
```

✅ 용어집이 적용되면 서버 시작 시 "용어집 로드 완료: 한→일 195개, 일→한 195개" 메시지가 표시됩니다!

---

## ❓ 문제 해결

### ❌ 음성이 감지되지 않아요
- ✅ Mac을 재부팅 했나요?
- ✅ Multi-Output Device에서 BlackHole과 스피커 둘 다 체크했나요?
- ✅ Zoom/Meet 스피커가 "다중 출력 장치"인가요?
- ✅ 번역기에서 "BlackHole 2ch"를 선택했나요?
- ✅ 상대방 언어에 맞는 듣기 모드를 선택했나요?

### ❌ 오디오 장치가 드롭다운에 안 보여요
- ✅ Chrome의 마이크 권한을 확인하세요
- ✅ 시스템 환경설정 > 보안 및 개인정보 보호 > 마이크 > Chrome 체크
- ✅ 브라우저를 완전히 종료 후 재시작
- ✅ 페이지의 🔄 버튼으로 새로고침

### ❌ 내 목소리가 안 들려요
- ✅ Multi-Output Device에서 스피커가 체크되어 있나요?

### ❌ 번역이 안 돼요
- ✅ DeepL API 키를 올바르게 입력했나요?
- ✅ 무료 사용량(월 50만자)이 남아있나요?
- ✅ 인터넷 연결을 확인하세요
- ✅ 프록시 서버가 실행 중인가요? (`./server-control.sh status`)

### ❌ 일본어 음성이 인식 안 돼요
- ✅ **"🎧 일본어 듣기 (0)"** 버튼을 선택했나요?
- ✅ 상대방 언어에 맞는 버튼을 클릭하세요!

### ❌ 세션이 저장이 안 돼요
- ✅ 시작-중지를 했나요? (중지할 때 자동 저장됩니다)
- ✅ 브라우저의 쿠키/저장소 설정을 확인하세요

### 📖 더 자세한 가이드
번역기 실행 후 **"📖"** 버튼을 누르면 더 자세한 단계별 안내를 볼 수 있습니다!

---

## 💰 비용

### 무료
- **Web Speech API** (음성 인식): 완전 무료
- **BlackHole** (오디오 캡처): 완전 무료
- **이 애플리케이션**: 완전 무료

### 유료 (매우 저렴!)
- **DeepL API**: 월 **50만 자 무료**
  - 초과 시: 100만 자당 $5.49 (매우 저렴)
  - 일반적인 1시간 회의: 약 5만~10만 자 = 무료!
  - https://www.deepl.com/ko/pro-api 에서 무료 가입

---

## ⚙️ 시스템 요구사항

### 필수
- **OS**: macOS 10.13 이상
- **브라우저**: Chrome 또는 Edge (Safari/Firefox는 Web Speech API 미지원)
- **인터넷**: 필수 (번역 API 사용)
- **Node.js**: 14.x 이상

### 권장
- **RAM**: 8GB 이상
- **CPU**: Intel Core i5 이상 또는 Apple Silicon
- **네트워크**: 안정적인 Wi-Fi 연결

---

## 🔒 개인정보 및 보안

- ✅ API 키는 **브라우저 localStorage**에만 저장 (외부 전송 안 됨)
- ✅ 모든 처리는 **내 컴퓨터**에서 실행
- ✅ 오디오는 **실시간 처리**만 되고 저장 안 됨
- ✅ 번역 히스토리는 **브라우저 내**에만 저장
- ✅ 세션 데이터는 **localStorage**에 로컬 저장
- ✅ 네트워크 공유 시에도 API 키는 각 기기에 따로 저장

---

## 🎓 작동 원리

### 화상회의 오디오 흐름
```
Google Meet / Zoom 오디오
        ↓
Multi-Output Device
        ├─→ [1] MacBook Pro 스피커 (볼륨 조절 가능)
        └─→ [2] BlackHole 2ch (항상 전송됨)
                    ↓
                번역기가 여기서 듣습니다
                    ↓
            Web Speech API (음성 → 텍스트)
                    ↓
            DeepL API (텍스트 번역)
                    ↓
            화면에 자막 표시
```

💡 **맥북 볼륨을 0으로 해도 BlackHole로는 계속 오디오가 전송되므로 번역이 정상 작동합니다!**

### 기술 스택
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Backend**: Node.js, Express
- **음성 인식**: Web Speech API (Chrome)
- **번역**: DeepL API
- **오디오 캡처**: BlackHole (가상 오디오 드라이버)
- **자동 시작**: macOS launchd

---

## 📁 프로젝트 구조

```
음성번역/
├── index.html              # 메인 UI
├── style.css              # 스타일시트
├── script.js              # 클라이언트 로직 (41KB)
├── proxy-server.js        # 번역 API 프록시 서버
├── server-control.sh      # 서버 관리 스크립트
├── glossary.json          # 용어집 데이터 (195개 용어)
├── load-terms.js          # 엑셀에서 용어집 로드
├── package.json           # npm 설정
└── README.md             # 이 문서
```

### 주요 기능별 코드
- **세션 관리**: `createNewSession()`, `saveCurrentSession()`, `loadSession()`, `deleteSession()`
- **히스토리**: `addToHistory()`, `renderHistory()`, `toggleStar()`, `deleteHistoryItem()`
- **음성 인식**: `startListening()`, `stopListening()`, `refreshAudioDevices()`
- **번역**: `translateText()`, `applyGlossary()`, `restoreGlossaryTerms()`
- **UI**: `updateLanguageButtons()`, `renderSessionTabs()`, `showFloatingSubtitle()`
- **네트워크**: `loadNetworkInfo()`, `toggleNetworkInfo()`, `displayNetworkInfo()`

---

## 🧪 테스트 완료 항목

### ✅ 기능 테스트 (100% 통과)
- [x] 서버 시작/중지/재시작
- [x] API 키 저장/복원
- [x] 오디오 장치 감지 및 선택
- [x] 음성 인식 (일본어/한국어)
- [x] DeepL 번역
- [x] 용어집 적용 (195개 용어)
- [x] 세션 생성/저장/로드/삭제
- [x] 히스토리 추가/삭제/검색
- [x] 별표 기능
- [x] 내보내기/복사
- [x] 플로팅 자막
- [x] 네트워크 정보 표시
- [x] QR 코드 생성
- [x] 키보드 단축키 (6개)
- [x] 자동 시작 (launchd)
- [x] UI 애니메이션

### ✅ 코드 품질
- [x] JavaScript 문법 검증
- [x] HTML 구조 검증
- [x] CSS 클래스 검증
- [x] 필수 ID 검증 (16개)
- [x] 함수 정의 검증 (18개)
- [x] 이벤트 리스너 검증

---

## 📝 버전 히스토리

### v4.0.0 (2025-12-13) - 현재 버전
- 🐾 **UI 대폭 개선**: 고양이 발바닥 아이콘 추가
- ✅ **세션 관리**: 10개 세션 자동 저장, × 버튼으로 삭제
- ✅ **검색 기능**: 모든 세션에서 검색 가능
- ✅ **단축키 추가**: `9`, `0` (언어 선택), `-`, `=` (시작/중지)
- ✅ **네트워크 공유**: QR 코드 생성, 다른 기기 접속
- ✅ **1줄 헤더**: 아이콘 버튼으로 UI 간소화
- ✅ **별표 기능**: 중요 대화 표시
- ✅ **시간대 그룹화**: 5분 단위 구분선
- ✅ **자동 시작**: launchd 통합
- ✅ **상세 에러 처리**: 오디오 장치 관련 상세 로그
- ✅ **히스토리 내보내기**: 텍스트 파일 저장
- ✅ **전수 조사 완료**: 모든 기능 검증

### v3.0.0 (2025-12-12)
- ✅ 양방향 번역 지원 (일본어↔한국어)
- ✅ 음성 인식 언어 선택 버튼 추가
- ✅ 용어집 학습 시스템 구현 (195개 게임 용어)
- ✅ DeepL API로 전환 (월 50만자 무료)
- ✅ 히스토리 개별 삭제 기능
- ✅ UI 개선 (가로 배치)
- ✅ 설정 가이드 전면 재작성

### v2.1.0 (2025-12-12)
- ✅ Google Meet 지원
- ✅ 권한 요청 개선

### v2.0.0 (2025-12-12)
- ✅ 시스템 오디오 캡처
- ✅ BlackHole 연동

### v1.0.0 (2025-12-12)
- 🎉 초기 릴리스

---

## 🤝 기여

이슈나 개선 사항이 있으면 언제든 알려주세요!

---

## 📄 라이선스

MIT License

---

## 📞 지원

**문제가 발생했나요?**
1. 이 README의 "문제 해결" 섹션 확인
2. 번역기 페이지의 **📖 설정 가이드** 버튼 클릭
3. `./server-control.sh logs`로 서버 로그 확인

---

**만든 날짜**: 2025년 12월 12일
**현재 버전**: 4.0.0
**최종 업데이트**: 2025년 12월 13일
**지원**: macOS 전용
**플랫폼**: Zoom, Google Meet
**테스트**: 전수 조사 완료 ✅

---

## 🎉 재밌는 사실

- 🐾 고양이 발바닥은 3초마다 좌우로 흔들립니다
- ⌨️ 키보드만으로 모든 기능을 조작할 수 있습니다
- 📱 QR 코드로 스마트폰에서도 접속 가능합니다
- 🔇 맥북 볼륨 0이어도 번역은 완벽하게 작동합니다!
- 💾 최대 10개 세션에 각각 100개씩 총 1000개의 대화를 저장할 수 있습니다

**즐거운 번역 되세요! 🎊**
